{
  "version": "1.0.0",
  "name": "Rupture Brutale des Relations Commerciales",
  "ontology": {
    "entities": [
      {
        "name": "CorporateEntity",
        "category": "ACTOR",
        "description": "Societe commerciale (Client/Fournisseur)",
        "key_fields": ["name", "role", "sector", "turnover_last_year"]
      },
      {
        "name": "ExtendedCommercialRelationship",
        "category": "CONCEPT",
        "description": "Relation commerciale etablie (duree, flux, dependance)",
        "key_fields": ["start_date", "financial_history", "dependency_rate", "characteristics"]
      },
      {
        "name": "RuptureContext",
        "category": "EVENT",
        "description": "Notification + execution de la rupture",
        "key_fields": ["notification_date", "effective_end_date", "mechanics", "executed_notice_period_months"]
      },
      {
        "name": "LogisticsCondition",
        "category": "FACT",
        "description": "Conditions commerciales (franco, paiement, etc.)",
        "key_fields": ["condition_name", "threshold_amount", "is_tacitly_renewable"]
      },
      {
        "name": "DigitalMessage",
        "category": "EVIDENCE",
        "description": "WhatsApp / Email / SMS utilises comme preuve",
        "key_fields": ["platform", "sender", "recipient", "date"]
      }
    ]
  },
  "rules": {
    "static": [
      {
        "rule_id": "L442-1-II",
        "description": "Preavis proportionne a l'anciennete",
        "logic_payload": {
          "if": {
            ">": ["seniority", 2],
            "then": 6,
            "else": 3
          }
        }
      },
      {
        "rule_id": "MISCONDUCT_GRACE",
        "description": "Faute grave autorise une rupture immediate",
        "logic_payload": {
          "if": {
            "and": [
              {">=": ["fault_severity", 8]},
              {"==": ["fault_condoned", false]}
            ],
            "then": "ALLOW_RUPTURE",
            "else": "CHECK_NOTICE"
          }
        }
      },
      {
        "rule_id": "TEMP_INTERRUPTION",
        "description": "Interruption temporaire < 3 mois + reprise identique = relation continue",
        "logic_payload": {
          "if": {
            "and": [
              {"<": ["interruption_months", 3]},
              {"==": ["reprise_conditions_identiques", true]}
            ],
            "then": {"relation_continue": true},
            "else": {"relation_continue": false}
          }
        }
      },
      {
        "rule_id": "PREAVIS_FORMEL",
        "description": "Preavis non ecrit ou intention equivogue = preavis invalide",
        "logic_payload": {
          "if": {
            "or": [
              {"!=": ["forme", "ECRIT"]},
              {"==": ["intention_rupture", "EQUIVOQUE"]}
            ],
            "then": {"preavis_valide": 0},
            "else": {"preavis_valide": 1}
          }
        }
      },
      {
        "rule_id": "RUPTURE_PARTIELLE",
        "description": "Baisse de volume, hausse de prix imposee ou perte d'exclusivite = rupture partielle",
        "logic_payload": {
          "if": {
            "or": [
              {">": ["baisse_volume", 40]},
              {">": ["hausse_prix", 15]},
              {"==": ["perte_exclusivite", true]}
            ],
            "then": {"rupture_partielle": true},
            "else": {"rupture_partielle": false}
          }
        }
      },
      {
        "rule_id": "FAUTE_GRAVE_NEMO_AUDITUR",
        "description": "Faute grave mais excuse si toleree ou provoquee par l'auteur",
        "logic_payload": {
          "if": {
            "and": [
              {"==": ["faute_commise", true]},
              {
                "or": [
                  {"==": ["tolerance_passee", true]},
                  {"==": ["faute_provoquee_par_auteur", true]}
                ]
              }
            ],
            "then": {"exoneration": false},
            "else": {"exoneration": "EVALUATE_FURTHER"}
          }
        }
      },
      {
        "rule_id": "DEPENDANCE_ECONOMIQUE",
        "description": "Part CA > 25% + impossibilite de substitution = facteur aggravant",
        "logic_payload": {
          "if": {
            "and": [
              {">": ["part_ca", 25]},
              {"==": ["impossibilite_substitution", true]}
            ],
            "then": {"facteur_aggravant": true},
            "else": {"facteur_aggravant": false}
          }
        }
      }
    ],
    "dynamic_templates": [
      {
        "rule_id": "interp_franco_tacite",
        "description": "Franco tacite impose un preavis aligne sur la duree initiale",
        "snippet": "def compute(condition):\\n    months = condition.get('initial_duration_months', 0)\\n    return max(months, 3)"
      },
      {
        "rule_id": "interp_unilateral_drop",
        "description": "Modification unilaterale = brutalite partielle",
        "snippet": "def compute(severity):\\n    return min(1.0, 0.4 + 0.5 * severity)"
      },
      {
        "rule_id": "interp_digital_written",
        "description": "Messages digitaux assimiles a un ecrit",
        "snippet": "def compute(msg):\\n    return msg.get('platform') in ['WHATSAPP','EMAIL','SMS']"
      },
      {
        "rule_id": "interp_competence_ny",
        "description": "Clause competence internationale declenche re-planification",
        "snippet": "def compute(text):\\n    return 'new york' in text.lower()"
      }
    ]
  },
  "planner": {
    "tasks": [
      {
        "id": "t_qualify_relation_existence",
        "action": "QUALIFY_RELATION_EXISTENCE",
        "priority": 100,
        "description": "Verifier autonomie des parties et realite des echanges (groupe / mandat / sous-traitance)."
      },
      {
        "id": "t_qualify_commercial_nature",
        "action": "QUALIFY_COMMERCIAL_NATURE",
        "priority": 95,
        "dependencies": ["t_qualify_relation_existence"],
        "description": "Confirmer le champ du Code de commerce (exclure activites civiles ou service public)."
      },
      {
        "id": "t_qualify_stability",
        "action": "QUALIFY_STABILITY",
        "priority": 90,
        "dependencies": ["t_qualify_commercial_nature"],
        "description": "Qualifier la stabilite (flux reguliers, croyance legitime, duree significative)."
      },
      {
        "id": "t_characterize_rupture",
        "action": "CHARACTERIZE_RUPTURE",
        "priority": 85,
        "dependencies": ["t_qualify_stability"],
        "description": "Qualifier rupture totale/partielle et imputabilite (initiative apparente vs reelle)."
      },
      {
        "id": "t_evaluate_brutality",
        "action": "EVALUATE_BRUTALITY",
        "priority": 80,
        "dependencies": ["t_characterize_rupture"],
        "description": "Verifier la forme du preavis et la poursuite effective pendant le delai."
      },
      {
        "id": "t_calculate_reasonable_notice",
        "action": "CALCULATE_REASONABLE_NOTICE",
        "priority": 75,
        "dependencies": ["t_evaluate_brutality"],
        "description": "Peser les facteurs aggravants/attenuants (Alexy) pour fixer le preavis raisonnable."
      },
      {
        "id": "t_check_exemptions",
        "action": "CHECK_EXEMPTIONS",
        "priority": 70,
        "dependencies": ["t_calculate_reasonable_notice"],
        "description": "Tester les defenses : faute grave, force majeure, crise sectorielle."
      }
    ]
  },
  "interpretations": [
    {
      "key": "franco_tacite",
      "rule_id": "interp_franco_tacite",
      "label": "Interpretation : Franco reconduit",
      "probability": 0.82,
      "description": "Un franco tacite impose de respecter la duree contractuelle dans le preavis."
    },
    {
      "key": "unilateral_modification",
      "rule_id": "interp_unilateral_drop",
      "label": "Interpretation : modification unilaterale",
      "probability": 0.8,
      "description": "Assimile les concessions imposees sans preavis a une rupture partielle."
    },
    {
      "key": "digital_written",
      "rule_id": "interp_digital_written",
      "label": "Interpretation : Message digital = ecrit",
      "probability": 0.78,
      "description": "Whatsapp/Email/SMS sont traites comme des notifications ecrites."
    },
    {
      "key": "clause_competence_ny",
      "rule_id": "interp_competence_ny",
      "label": "Clause de competence New York",
      "probability": 0.7,
      "description": "Declenche une re-planification pour verifications de competence."
    }
  ],
  "alexy_weights": [
    {"principle_name": "ANCIENNETE_RELATION", "intensity": 9.0, "abstract_weight": 9.0, "reliability": 0.9},
    {"principle_name": "DEPENDANCE_ECONOMIQUE", "intensity": 8.0, "abstract_weight": 8.0, "reliability": 0.85},
    {"principle_name": "INVESTISSEMENTS_SPECIFIQUES", "intensity": 9.0, "abstract_weight": 8.5, "reliability": 0.82},
    {"principle_name": "EXCLUSIVITE", "intensity": 7.0, "abstract_weight": 6.5, "reliability": 0.78},
    {"principle_name": "PRODUITS_MDD", "intensity": 6.5, "abstract_weight": 6.5, "reliability": 0.75},
    {"principle_name": "SAISONNALITE", "intensity": 6.0, "abstract_weight": 5.5, "reliability": 0.7},
    {"principle_name": "NOTORIETE_AUTEUR", "intensity": 5.5, "abstract_weight": 5.0, "reliability": 0.7},
    {"principle_name": "FAUTE_SIMPLE_VICTIME", "intensity": 6.0, "abstract_weight": 6.0, "reliability": 0.72},
    {"principle_name": "PRECARITE_SECTEUR", "intensity": 6.0, "abstract_weight": 5.5, "reliability": 0.68},
    {"principle_name": "FAIBLE_VOLUME_AFFAIRES", "intensity": 4.0, "abstract_weight": 4.5, "reliability": 0.65},
    {"principle_name": "CRISE_OU_FORCE_MAJEURE", "intensity": 8.5, "abstract_weight": 7.5, "reliability": 0.8},
    {"principle_name": "FACILITE_RECONVERSION", "intensity": 6.5, "abstract_weight": 6.0, "reliability": 0.7}
  ]
}
